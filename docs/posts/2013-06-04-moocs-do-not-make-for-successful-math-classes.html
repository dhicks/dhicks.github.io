<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dan Hicks">
<meta name="dcterms.date" content="2013-06-04">

<title>MOOCs do not Make for Successful Math Classes – Dan Hicks</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/academicons-1.9.2/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/academicons-1.9.2/size.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="MOOCs do not Make for Successful Math Classes – Dan Hicks">
<meta property="og:description" content="Website description">
<meta property="og:site_name" content="Dan Hicks ">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Dan Hicks</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../research.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-teaching" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Teaching</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-teaching">    
        <li>
    <a class="dropdown-item" href="https://data-science-methods.github.io/">
 <span class="dropdown-text">Methods of Data Science</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://fairy-shrimp.netlify.app/">
 <span class="dropdown-text">Notes for Critical Reasoning</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://orcid.org/0000-0001-7945-4416"> 
<span class="menu-text"><i class="fa-brands fa-orcid" aria-label="orcid"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://scholar.google.com/citations?user=XvkwYZsAAAAJ&amp;hl=en"> 
<span class="menu-text"><i class="ai  ai-google-scholar" title="" style="color:"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://dhicks.github.io/cv"> 
<span class="menu-text"><i class="ai  ai-cv" title="" style="color:"></i></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/dhicks/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:dhicks4@ucmerced.edu"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">MOOCs do not Make for Successful Math Classes</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">automated</div>
                <div class="quarto-category">data</div>
                <div class="quarto-category">instructor</div>
                <div class="quarto-category">math</div>
                <div class="quarto-category">moocs</div>
                <div class="quarto-category">students</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Dan Hicks </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 4, 2013</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>In this post, I’m going to discuss MOOCs, based on my recent experience in a <a href="https://class.coursera.org/networksonline-001/class/index">Coursera course on Social and Economic Networks</a>. I’m going to start with a brief explanation of my reasons for taking the course, give a quick overview of the structure of the course, then explain my criticism. I’ll end up arguing that, perhaps surprisingly, MOOCs are not effective, even for the math courses that, it would seem, they’re perfect for.</p>
<p>I decided to take this course for two primary reasons:</p>
<ol type="1">
<li>MOOCs are the subject of a lot of discussion in higher education right now. I’m deeply skeptical of them, but so far my worries haven’t really been empirically grounded.</li>
<li>I’m quite interested in the new field of network science, and this seemed like a good opportunity to learn a bit about it.</li>
</ol>
<p>Let’s start with a brief, purely descriptive overview of the course. It was an introduction to network theory, with an emphasis on economics-style model building and analysis. (The lectures were given by Matthew Jackson, who’s in the economics department at Stanford.) While we did cover some empirical tools, and the lectures occasionally gestured in the direction of data analysis, for the most part this was essentially a math class, and the lectures relied heavily on advanced undergraduate or master’s level linear algebra and probability theory.</p>
<p>As you probably know if you’re already familiar with MOOCs, the lectures for each week were short videos, with the instructor greenscreened onto PowerPoint slides. Our videos were significantly longer than I had been led to expect, with individual videos typically 15-20 minutes long and a total of 90-120 minutes of video each week. The videos were interrupted every few minutes with a multiple-choice quiz question. The question could be skipped, and wasn’t graded. The assigned work for each week was a problem set of multiple-choice questions. There was also a final exam. “Passing” the class required completing earning at least 70% of the total possible credit. Note that, because I spent last week moving and then went out of town for a conference, I didn’t take the final exam; but I assume it was also multiple-choice questions. Also, since I ended up at 65% of the total possible points, I didn’t “pass” the class.</p>
<p>Interaction between the instructor and students was basically nonexistent; this is going to be the core of my criticism below. While there was a text-based asynchronous discussion board, I only saw the instructor post anything there once. There was also a Google Hangouts chat (similar to Skype) near the end of the 8-week session, in which a handful of students got to ask the instructor questions live, for about half an hour. That session is available on <a href="https://www.youtube.com/watch?v=AAgX0HwEiVg">YouTube</a>. There was also a TA, who apparently is one of the instructor’s graduate students at Stanford. The TA interacted a bit more with the students on the discussion board, but seemed to primarily handle technical issues (e.g., mid-video discussion questions that had been coded incorrectly) and writing the quiz and problem set questions, as well as the explanations for the correct answers. As far as I know, he never provided additional explanations of lectures or answers to questions. This was pretty much left to other students.</p>
<p>I found that this course worked well for me. I found most of the material interesting, never had problems with any of the assigned work that I couldn’t puzzle out in a few minutes (note again that I didn’t take the final exam), and learned a lot. However, based in part on my own background teaching math and my interactions with the other students in the discussion boards, I think my experience was exceptional. I have a master’s degree in math and lots of practice learning new areas of math on my own. (For example, I took graduate courses in mathematical logic without ever taking undergraduate logic.) I also taught myself the programming language Python this past winter, and I learned a lot by writing Python routines to implement various ideas presented in the lectures.</p>
<p>By contrast, my fellow students had a lot of questions, and early on one of the most active discussion threads comprised complaints about the difficulty of the course. The lectures were given at a high level of abstraction, and often both the definitions of new terminology and the examples used to illustrate those ideas were shortchanged. In a few cases, upon closer examination (by the students), it wasn’t clear how the example was supposed to illustrate the definition or principle, or the example appeared to involve a typo or miscalculation. I’m going to come back to these points in a few paragraphs.</p>
<p>My critique of this course — and, by extension, MOOCs in general — can be summarized as follows:</p>
<ol type="1">
<li>A successful math course requires communication from the students to the instructor.</li>
<li>MOOCs effectively all-but-close the channels for this communication.</li>
<li>Hence, math MOOCs cannot be successful.</li>
</ol>
<p>I’m going to speak specifically about math courses here. I’m doing this for two reasons. First, while my course was taught by an economist, it was basically a math course, and I think it’s safe to generalize from it to other math courses. Second, it seems that, if MOOCs are successful in any field, they would be successful in math. Humanities courses obviously require too much moderated discussion and their writing assignments can’t be graded automatically. (Despite edX’s efforts, they simply aren’t going to be able to develop a computer program that can judge how accurately a student has reconstructed Descartes’ argument for mind-body dualism, or how insightful their criticism of this argument is.) There’s no replacement for a physical lab in science courses. On the other hand, insofar as students in math classes are learning how to solve certain kinds of problems, it seems like there’s no difference between a live lecture and a MOOC. Thus my conclusion — that math MOOCs cannot be successful — is especially surprising.</p>
<p>I could offer some general reasons to support my first premise, i.e., reasons why <em>any</em> successful course requires student-instructor communication. But instead I’m going to give a math-specific reason.</p>
<p>In a live math class — as well as a sufficiently small online math class — the instructor can interact with the students regularly, and consequently can develop a good understanding of what math teachers (especially at the primary and secondary level) call the <strong>mathematical maturity</strong> of the students, both as a whole class and individually. Mathematical maturity includes both the mathematical knowledge that students already have — whether or not they know what eigenvectors are, say — but also their ability to think abstractly. For example, junior high algebra students think of functions as <em>operations that are done to numbers</em>. By the time they’re high school seniors, they’re starting to think of functions as <em>things</em>, namely <em>curves on a plane</em>, and they’re ready to think of derivatives and integrals as <em>operations that are done to these curves</em>. It’s a few more years before they’re ready to think of both functions and derivatives as <em>algebraic objects</em>, in the way that studying differential forms requires.</p>
<p>Learning to gauge mathematical maturity has been crucial in my summer work, teaching math and logic to gifted and talented teenagers at Johns Hopkins’ Center for Talented Youth. These kids are certainly bright, but generally aren’t very far beyond their age level in terms of mathematically maturity. I was initially hired to teach a class on chaos theory and fractals. This class failed pretty much completely, all three times that I taught it, because (for example) students weren’t sufficiently mathematically mature to understand the concept of phase space, and this concept is crucial to understand chaos theory. By contrast, because one can teach formal logic as pushing around symbols — like high school algebra — it works beautifully with these teenagers.</p>
<p><strong>In short, any successful math class requires that the instructor accurately gauge the students’ mathematical maturity. And, obviously, this requires communication from the students to the instructor.</strong></p>
<p>For the second premise, start by considering the channels for student-instructor communication in a traditional live lecture course. In this setting, students can interrupt the lecture — they can ask for additional clarification, an example (or an additional example) to illustrate the point under discussion, or point out possible mistakes. (Math teachers make mistakes regularly; it’s simply unavoidably easy to copy numbers incorrectly out of one’s notes or make a mental arithmetic error.)</p>
<p>In any asynchronous online course — whether it’s a 30-person online section or a MOOC — the lectures will be prerecorded, and students won’t be able to interrupt the lecture for any of the things I listed in the last paragraph. But in both a live course and a smaller online course students can also talk to the instructor outside of class, whether in person or using email or an asynchronous online discussion board. This isn’t quite as good as a question asked during a live lecture — typically more students will be confused about something than just the one who asks the question — but it still creates a channel by which the instructor can gauge the students’ mathematical maturity.</p>
<p>A third channel is through graded work. Students in math courses hate being told to “show their work” — especially the students with the most “natural” understanding of the problems — but this often gives instructors valuable insight into how students are understanding the problems, and by extension the concepts relevant to the problems. Students who try to solve an algebra problem by “guess and check” — plugging in values until they get one that works — are probably at a lower level of mathematical maturity than students who use symbolic manipulations.</p>
<p>So, we have three main channels for student-instructor communication: questions during lecture, questions outside of lecture, and the work done on graded assignments. MOOCs, as per my second premise, close off all three of these channels.</p>
<p>It’s clear that MOOCs close off the first channel: the lectures are prerecorded videos. The students can pause and rewind, but can’t ask a question or point out a problem. As I mentioned above, it seemed to me and a few other students that there were a few typos and bad examples in the lectures, and these were never corrected or given more adequate explanations. Because this channel has, in some sense, a significantly higher bitrate than the other two, and both MOOCs and smaller asynchronous online courses close it off, it seems to me that this is a devastating problem for both kinds of online courses.</p>
<p>I’ll come back to the second channel, questions asked outside of class time. The third channel is through graded work. At least in my course, graded work was exclusively answering multiple-choice questions. There was no way to “show your work,” and indeed it seems to me that computer evaluation of student efforts to solve math problems would be about as difficult to implement as computer evaluation of written assignments for a humanities MOOC. Furthermore, the logistics of a MOOC require several intermediaries between the instructor and the students’ submitted work, including the automated grading system and the TA. Perhaps student submissions could be randomly sampled, but of course it would be an enormous amount of person-hours to review a genuinely representative sample. Hence, MOOCs close off this third channel even more severely than smaller online asynchronous courses, at least in principle.</p>
<p>Finally we have questions asked outside of class time, which in the case of a MOOC means the discussion board. As with the second channel, the logistics of MOOCs prevent the instructor from being heavily involved in the boards. They simply can’t respond to every question from the thousands of students in the course. Even a handful of TAs couldn’t keep up if the course is really larger than a couple hundred students; and then there’s the problem of effectively feeding these into the lectures.</p>
<p>Note that an smaller online asynchronous course does not close off this channel. In a 30-person course, the instructor can still take questions from the students on the discussion board. For this reason, while I think that MOOCs as such cannot be successful, smaller online courses might still be. As I said above, I think this channel has a much lower bitrate than live questions, and so I remain skeptical about smaller online asynchronous courses. But I’m willing to give them the benefit of the doubt for the purposes of this post.</p>
<p><strong>So, all together, MOOCs close the three channels of student-instructor communication found in a traditional live math course.</strong> They do not, as far as I can tell, open any alternative channels. And hence, combined with the first premise, it follows that MOOCs cannot be successful. MOOCs prevent instructors in math courses from accurately gauging the mathematical maturity of the students, and hence prevent these courses from succeeding.</p>
<p>It does not seem to me that there is any way for MOOCs to avoid this problem. If it were possible for them to create a new channel for student-instructor communication, then perhaps they could. But, by definition, we’re talking about a student-teacher ratio in the thousands. There’s no way for the instructor to keep up with the deluge of student questions.</p>
<div id="footer">
<p><span id="timestamp">June 4th, 2013 12:37pm</span> <span class="tag">higher education</span> <span class="tag">teaching</span> <span class="tag">mooc</span></p>
</div>



<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-copyright"><h2 class="anchored quarto-appendix-heading">Copyright</h2><div class="quarto-appendix-contents"><div>Dan Hicks</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/dhicks\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>